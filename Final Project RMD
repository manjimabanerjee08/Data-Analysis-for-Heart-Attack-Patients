---
title: 'Final Project'
author: "Can Yildiz, Manjima Banerjee"
date: "DUE: April 19 @  PM"
output: pdf_document
urlcolor: blue
---

```{r message=FALSE}
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(latex2exp)
library(boot)
```


```{r message=FALSE}
heart_attack <- read.csv("heart_attack.csv") # Load in the heart attack data
glimpse(heart_attack) 
summary(heart_attack)
```

```{r}
# Data cleaning
chol<- heart_attack[complete.cases(heart_attack$chol),] 
age <- heart_attack[complete.cases(heart_attack$age),]
```

```{r}
#1. Numerical summary of our Simple regression analysis
lmHeart=lm(age~chol, data= heart_attack)
summary(lmHeart)
```


```{r }
# 2.Simple Linear Regression Analysis for Age and Cholesterol Levels.
ggplot(heart_attack) + 
geom_point(aes(x= age, y= chol) ,
na.rm=T)+
labs(x='Age',y='Cholesterol',
title='Scatter plot of Age and Cholesterol', subtitle= "n= 303") + 
geom_smooth(method=lm, aes(x=age, y= chol))


```


```{r}
# Histogram of Age and Cholesterol Levels.
par(mfrow=c(1,2))
hgA <- hist(x=heart_attack$age,,xlab= "Age", main= "Histogram of Age")
hgC<-hist(x=heart_attack$chol, xlab= "Cholesterol", 
main= "Histogram of Cholesterol" )
```

```{r}
#3. Boxplot for Cholesterol levels and Age of Patients
ggplot(heart_attack)+ geom_boxplot(aes(x=age, y=chol,group=1)) + 
  labs(x= "Age", y= "Cholesterol",
title= "Cholesterol distribution based on Age")
```



```{r}
#4.Side by Side Boxplots for Male and Female Cholesterol levels
# Create vectors containing the observed data for gender
index.sex <- heart_attack$sex == "1"
obs.male <- heart_attack$chol[index.sex]
obs.female <- heart_attack$chol[!index.sex]


dat <- tibble(genders=c(heart_attack$chol[index.sex], 
heart_attack$chol[!index.sex]),type = c(rep('male', 207), rep('female', 96)))

ggplot(dat, aes(x= type, y= genders)) +
geom_boxplot() + labs(x ="Cholesterol Data",
y = "Cholesterol Level",
subtitle = "Compare Distribution of Cholesterol level between genders") +
scale_x_discrete(labels = c ( "Male","Female"))+ theme_light()
                        
```


```{r}
#5. Normal QQ Plot for Distribution of Cholesterol Levels

x_bar <- mean(heart_attack$chol)
heart_attack %>%
ggplot(aes(sample = chol))+
geom_qq()+
geom_qq_line()+
labs(x = TeX(r'($N(0,1)$ Quantiles)'),
y = "cholesterol level quantiles",
title = "Normal Q-Q plot",
subtitle = "Data: cholesterol level")
```


```{r}

t.test(obs.female,obs.male) #Two-Sample T-test with Unequal Variance
```

```{r}
#Bootstrap confidence interval for the difference in means
# Create vectors containing the observed data for gender
index.sex <- heart_attack$sex == "1"
obs.male <- heart_attack$chol[index.sex]
obs.female <- heart_attack$chol[!index.sex]

set.seed(238)
B <- 5000
boot.mean.diff <- c()

for(b in 1:B){
# Bootstrap sample for each gender
boot.male <- sample(obs.male, replace = TRUE)
boot.female <- sample(obs.female, replace = TRUE)
# Compute difference in bootstrap means
boot.mean.diff[b] <- mean(boot.male) - mean(boot.female)
}
 


```

```{r}
#Calculating the  95% confidence intervals
ci.mean.diff <- quantile(boot.mean.diff, probs = c(0.025, 0.975))
ci.mean.diff
```

